{{ define "main" }}
 
    <section class="page-content latest-cards-section">
    <h1>{{ .Title }}</h1>
        {{ .Content }}
		
	{{ $key := printf "latest.%s" .Language }}
	{{ $data := index site.Data $key }}
	{{ if $data }}
	
	{{ $pageSize := site.Params.newsPaginationLimit | default 10 }}

	<ul class="latest-cards" id="news-list" data-page-size="{{ $pageSize }}">
		{{ range $data }}
			<li class="news-item">
				{{ partial "latest-card" . }}
			</li>
		{{ end }}
	</ul>

	<div id="pagination" class="pagination-container">
		<button class="pagination-arrow prev disabled" onclick="changePage(-1)">
			<span class="material-symbols-outlined">chevron_left</span>
		</button>
		<div id="page-numbers" class="pagination-numbers">
			<!-- Page numbers will be generated by JS -->
		</div>
		<button class="pagination-arrow next" onclick="changePage(1)">
			<span class="material-symbols-outlined">chevron_right</span>
		</button>
	</div>

	<script>
		const listElement = document.getElementById('news-list');
		const items = listElement.getElementsByClassName('news-item');
		const pageSize = parseInt(listElement.getAttribute('data-page-size'));
		const pageNumbersContainer = document.getElementById('page-numbers');
		const totalPages = Math.ceil(items.length / pageSize);
		let currentPage = 1;

		function showPage(page) {
			currentPage = page;
			const start = (page - 1) * pageSize;
			const end = start + pageSize;

			for (let i = 0; i < items.length; i++) {
				if (i >= start && i < end) {
					items[i].classList.remove('hidden');
				} else {
					items[i].classList.add('hidden');
				}
			}

			updatePagination();
			window.scrollTo({ top: listElement.offsetTop - 100, behavior: 'smooth' });
		}

		function updatePagination() {
			pageNumbersContainer.innerHTML = '';
			
			for (let i = 1; i <= totalPages; i++) {
				const btn = document.createElement('button');
				btn.innerText = i;
				btn.className = 'pagination-button' + (i === currentPage ? ' active' : '');
				btn.onclick = () => showPage(i);
				pageNumbersContainer.appendChild(btn);
			}

			document.querySelector('.pagination-arrow.prev').classList.toggle('disabled', currentPage === 1);
			document.querySelector('.pagination-arrow.next').classList.toggle('disabled', currentPage === totalPages);
		}

		function changePage(delta) {
			const newPage = currentPage + delta;
			if (newPage >= 1 && newPage <= totalPages) {
				showPage(newPage);
			}
		}

		// Initial display
		if (items.length > pageSize) {
			showPage(1);
		} else {
			document.getElementById('pagination').style.display = 'none';
		}
	</script>

{{ else }}
    {{ errorf "Cannot find latest news data for language '%s'" .Language }}
{{ end }}
      
    </section>
{{ end }}